{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Liste des personnes recens√©es</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      --warning-gradient: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
      --card-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
      --card-hover-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
      --text-primary: #2c3e50;
      --text-secondary: #718096;
      --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--bg-gradient);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      color: var(--text-primary);
      overflow-x: hidden;
    }

    .container {
      max-width: 1600px;
      position: relative;
    }

    .header-section {
      text-align: center;
      margin-bottom: 3rem;
      position: relative;
    }

    .header-title {
      font-size: 3rem;
      font-weight: 800;
      background: var(--primary-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1rem;
      animation: fadeInUp 1s ease-out;
    }

    .header-subtitle {
      font-size: 1.1rem;
      color: var(--text-secondary);
      font-weight: 300;
      animation: fadeInUp 1s ease-out 0.2s both;
    }

    /* Statistiques Dashboard */
    .stats-dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
      animation: fadeInUp 1s ease-out 0.4s both;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 16px;
      padding: 1.5rem;
      text-align: center;
      box-shadow: var(--card-shadow);
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--card-hover-shadow);
    }

    .stat-icon {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      display: block;
    }

    .stat-card.total .stat-icon { color: #667eea; }
    .stat-card.validated .stat-icon { color: #10b981; }
    .stat-card.rejected .stat-icon { color: #ef4444; }
    .stat-card.pending .stat-icon { color: #f59e0b; }

    .stat-number {
      font-size: 2rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
    }

    .stat-label {
      font-size: 0.9rem;
      color: var(--text-secondary);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Filtres */
    .filters-section {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      box-shadow: var(--card-shadow);
      animation: fadeInUp 1s ease-out 0.6s both;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: 1fr auto auto auto;
      gap: 1rem;
      align-items: end;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .filter-label {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .form-control, .form-select {
      border-radius: 12px;
      border: 2px solid rgba(103, 126, 234, 0.1);
      padding: 0.75rem 1rem;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.8);
    }

    .form-control:focus, .form-select:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 0.2rem rgba(103, 126, 234, 0.25);
      background: white;
    }

    .btn-filter {
      padding: 0.75rem 1.5rem;
      border-radius: 12px;
      font-weight: 600;
      transition: all 0.3s ease;
      border: none;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .btn-primary {
      background: var(--primary-gradient);
      color: white;
      box-shadow: 0 5px 15px rgba(103, 126, 234, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(103, 126, 234, 0.6);
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background: #5a6268;
      transform: translateY(-2px);
    }

    /* Cartes de profil - plus compactes */
    .profile-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 16px;
      box-shadow: var(--card-shadow);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      position: relative;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      transform: translateY(0);
      border: 1px solid rgba(255, 255, 255, 0.2);
      height: fit-content;
    }

    .profile-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      transition: left 0.8s;
    }

    .profile-card:hover::before {
      left: 100%;
    }

    .profile-card:hover {
      transform: translateY(-5px) scale(1.01);
      box-shadow: var(--card-hover-shadow);
    }

    .profile-card.validated {
      border: 2px solid #10b981;
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);
    }

    .profile-card.rejected {
      border: 2px solid #ef4444;
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);
    }

    .profile-card.hidden {
      display: none;
    }

    /* Avatar plus compact */
    .avatar-container {
      position: relative;
      margin: 0 auto 1rem;
      width: 80px;
      height: 80px;
    }

    .avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 3px solid transparent;
      background: var(--primary-gradient);
      padding: 3px;
      object-fit: cover;
      transition: all 0.3s ease;
    }

    .avatar-inner {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
    }

    .status-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      color: white;
      opacity: 0;
      transform: scale(0);
      transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    .status-badge.validated {
      background: linear-gradient(135deg, #10b981, #059669);
      opacity: 1;
      transform: scale(1);
    }

    .status-badge.rejected {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      opacity: 1;
      transform: scale(1);
    }

    .person-name {
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      background: var(--primary-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-align: center;
    }

    /* Grille d'informations plus compacte */
    .info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.8rem;
      margin-bottom: 1rem;
    }

    .info-item {
      background: rgba(103, 126, 234, 0.05);
      padding: 0.8rem;
      border-radius: 12px;
      border-left: 3px solid var(--primary-gradient);
      transition: all 0.3s ease;
    }

    .info-item:hover {
      transform: translateX(3px);
      background: rgba(103, 126, 234, 0.1);
    }

    .info-label {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: 0.3rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .info-value {
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .info-item-full {
      grid-column: 1 / -1;
    }

    /* Section d'analyse IA agrandie */
    .analysis-section {
      background: rgba(103, 126, 234, 0.05);
      padding: 1.2rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
      border: 1px solid rgba(103, 126, 234, 0.1);
    }

    .analysis-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.8rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .analysis-content {
      max-height: 200px;
      overflow-y: auto;
      font-size: 0.9rem;
      line-height: 1.5;
      color: var(--text-secondary);
      scrollbar-width: thin;
      scrollbar-color: rgba(103, 126, 234, 0.3) transparent;
      padding-right: 0.5rem;
    }

    .analysis-content::-webkit-scrollbar {
      width: 6px;
    }

    .analysis-content::-webkit-scrollbar-thumb {
      background: rgba(103, 126, 234, 0.3);
      border-radius: 3px;
    }

    /* Boutons d'action plus compacts */
    .action-buttons {
      display: flex;
      gap: 0.8rem;
      justify-content: center;
    }

    .btn-action {
      padding: 0.7rem 1.5rem;
      border-radius: 25px;
      font-weight: 600;
      font-size: 0.85rem;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      border: none;
      cursor: pointer;
    }

    .btn-action::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .btn-action:hover::before {
      left: 100%;
    }

    .btn-validate {
      background: var(--success-gradient);
      color: white;
      box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
    }

    .btn-validate:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 8px 20px rgba(79, 172, 254, 0.5);
      color: white;
    }

    .btn-reject {
      background: var(--danger-gradient);
      color: white;
      box-shadow: 0 5px 15px rgba(250, 112, 154, 0.3);
    }

    .btn-reject:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 8px 20px rgba(250, 112, 154, 0.5);
      color: white;
    }

    .btn-action:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    /* Modal overlay */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    /* Modal container */
    .modal-container {
      background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
      border-radius: 20px;
      padding: 0;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 25px 60px rgba(0,0,0,0.3);
      transform: scale(0.7) translateY(50px);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      overflow: hidden;
    }

    .modal-overlay.active .modal-container {
      transform: scale(1) translateY(0);
    }

    /* Modal header */
    .modal-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 25px 30px;
      text-align: center;
      position: relative;
    }

    .modal-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
    }

    .modal-header-content {
      position: relative;
      z-index: 2;
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .modal-subtitle {
      opacity: 0.9;
      font-size: 0.95rem;
    }

    .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 3;
    }

    .close-btn:hover {
      background: rgba(255,255,255,0.3);
      transform: rotate(90deg);
    }

    /* Modal body */
    .modal-body {
      padding: 30px;
    }

    .form-group {
      margin-bottom: 25px;
    }

    .form-label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
      font-size: 0.95rem;
    }

    .form-select {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid #e1e8f0;
      border-radius: 12px;
      font-size: 1rem;
      background: white;
      color: #333;
      transition: all 0.3s ease;
      appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 12px center;
      background-repeat: no-repeat;
      background-size: 16px;
    }

    .form-select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .form-select:hover {
      border-color: #667eea;
    }

    /* Modal actions */
    .modal-actions {
      display: flex;
      gap: 15px;
      margin-top: 30px;
    }

    .btn {
      flex: 1;
      padding: 15px 25px;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .btn-secondary {
      background: #f1f5f9;
      color: #64748b;
      border: 2px solid #e2e8f0;
    }

    .btn-secondary:hover {
      background: #e2e8f0;
      color: #475569;
      transform: translateY(-1px);
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: 2px solid transparent;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    /* Success animation */
    .success-message {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      margin-top: 20px;
      display: none;
      animation: slideInUp 0.5s ease;
    }

    .success-message.show {
      display: block;
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Loading animation */
    .btn-primary.loading {
      position: relative;
      color: transparent;
    }

    .btn-primary.loading::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255,255,255,0.3);
      border-top: 2px solid white;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: translate(-50%, -50%) rotate(360deg); }
    }

    /* Particules flottantes */
    .floating-particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .particle {
      position: absolute;
      background: rgba(103, 126, 234, 0.1);
      border-radius: 50%;
      animation: float-particle 15s infinite linear;
    }

    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .loader {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(103, 126, 234, 0.2);
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    .no-results {
      text-align: center;
      padding: 3rem;
      color: var(--text-secondary);
      font-size: 1.1rem;
    }

    .no-results i {
      font-size: 4rem;
      margin-bottom: 1rem;
      color: rgba(103, 126, 234, 0.3);
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    @keyframes float-particle {
      0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100vh) rotate(360deg);
        opacity: 0;
      }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .card-enter {
      animation: cardEnter 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    @keyframes cardEnter {
      from {
        opacity: 0;
        transform: translateY(30px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .filters-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      
      .filters-grid .filter-group:last-child {
        grid-column: 1;
        display: flex;
        flex-direction: row;
        gap: 1rem;
      }
    }

    @media (max-width: 768px) {
      .header-title {
        font-size: 2.2rem;
      }
      
      .stats-dashboard {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .info-grid {
        grid-template-columns: 1fr;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .btn-action {
        justify-content: center;
      }

      .modal-container {
        width: 95%;
        margin: 20px;
      }
      
      .modal-body {
        padding: 20px;
      }
      
      .modal-actions {
        flex-direction: column;
      }
    }

    @media (max-width: 576px) {
      .stats-dashboard {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="floating-particles" id="particles"></div>
  
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loader"></div>
  </div>

  <div class="container my-4">
    <div class="header-section">
      <h1 class="header-title">
        <i class="fas fa-users me-3"></i>
        Analyse des Recensements
      </h1>
      <p class="header-subtitle">Validation et traitement des donn√©es collect√©es</p>
    </div>

    <!-- Dashboard des statistiques -->
    <div class="stats-dashboard">
      <div class="stat-card total">
        <i class="fas fa-users stat-icon"></i>
        <div class="stat-number" id="totalCount">{{ personnes|length }}</div>
        <div class="stat-label">Total</div>
      </div>
      <div class="stat-card validated">
        <i class="fas fa-check-circle stat-icon"></i>
        <div class="stat-number" id="validatedCount">0</div>
        <div class="stat-label">Valid√©es</div>
      </div>
      <div class="stat-card rejected">
        <i class="fas fa-times-circle stat-icon"></i>
        <div class="stat-number" id="rejectedCount">0</div>
        <div class="stat-label">Rejet√©es</div>
      </div>
      <div class="stat-card pending">
        <i class="fas fa-clock stat-icon"></i>
        <div class="stat-number" id="pendingCount">{{ personnes|length }}</div>
        <div class="stat-label">En attente</div>
      </div>
    </div>

    <!-- Section des filtres -->
    <div class="filters-section">
      <div class="filters-grid">
        <div class="filter-group">
          <label class="filter-label">Recherche par nom</label>
          <input type="text" class="form-control" id="nameFilter" placeholder="Rechercher une personne...">
        </div>
        <div class="filter-group">
          <label class="filter-label">Statut</label>
          <select class="form-select" id="statusFilter">
            <option value="all">Tous les statuts</option>
            <option value="pending">En attente</option>
            <option value="validated">Valid√©es</option>
            <option value="rejected">Rejet√©es</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">&nbsp;</label>
          <button type="button" class="btn btn-primary btn-filter" onclick="applyFilters()">
            <i class="fas fa-filter me-2"></i>Filtrer
          </button>
        </div>
        <div class="filter-group">
          <label class="filter-label">&nbsp;</label>
          <button type="button" class="btn btn-secondary btn-filter" onclick="resetFilters()">
            <i class="fas fa-undo me-2"></i>Reset
          </button>
        </div>
      </div>
    </div>

    <!-- Conteneur des cartes -->
    <div id="cardsContainer">
      {% for personne in personnes %}
        {% if forloop.first or forloop.counter0|divisibleby:4 %}
          <div class="row">
        {% endif %}
        
        <div class="col-xl-3 col-lg-4 col-md-6">
          <div class="profile-card card-enter" 
               data-person-id="{{ personne.id }}" 
               data-index="{{ forloop.counter0 }}"
               data-name="{{ personne.first_name|lower }} {{ personne.last_name|lower }}"
               data-status="{% if personne.validated_by_admin %}validated{% else %}pending{% endif %}">
            
            <div class="avatar-container">
              <div class="avatar">
                {% if personne.photo %}
                  <img src="{{ personne.photo.url }}" alt="Photo de {{ personne.first_name }}" class="avatar-inner" />
                {% else %}
                  <img src="{% static 'images/default_avatar.png' %}" alt="Avatar par d√©faut" class="avatar-inner" />
                {% endif %}
              </div>
              <div class="status-badge {% if personne.validated_by_admin %}validated{% endif %}" id="status-{{ personne.id }}">
                {% if personne.validated_by_admin %}
                  <i class="fas fa-check"></i>
                {% else %}
                  <i class="fas fa-clock"></i>
                {% endif %}
              </div>
            </div>

            <h3 class="person-name">{{ personne.first_name }} {{ personne.last_name }}</h3>

            <div class="info-grid">
              <div class="info-item">
                <div class="info-label">
                  <i class="fas fa-user-tie me-1"></i>
                  Recenseur
                </div>
                <div class="info-value">
                  {% if personne.recenseur %}{{ personne.recenseur.username }}{% else %}N/A{% endif %}
                </div>
              </div>

              <div class="info-item">
                <div class="info-label">
                  <i class="fas fa-chart-line me-1"></i>
                  Pauvret√©
                </div>
                <div class="info-value">{{ personne.niveau_pauvrete|default:"N/A" }}%</div>
              </div>

              <div class="info-item">
                <div class="info-label">
                  <i class="fas fa-envelope me-1"></i>
                  Email
                </div>
                <div class="info-value">{{ personne.email|truncatechars:20 }}</div>
              </div>

              <div class="info-item">
                <div class="info-label">
                  <i class="fas fa-phone me-1"></i>
                  T√©l√©phone
                </div>
                <div class="info-value">{{ personne.telephone|default:"N/A" }}</div>
              </div>

              <div class="info-item info-item-full">
                <div class="info-label">
                  <i class="fas fa-tag me-1"></i>
                  Cat√©gorie
                </div>
                <div class="info-value">{{ personne.entite|default:"Non d√©termin√©e" }}</div>
              </div>

              <div class="info-item info-item-full">
                <div class="info-label">
                  <i class="fas fa-map-marker-alt me-1"></i>
                  R√©gion
                </div>
                <div class="info-value">{{ personne.region_geographique|default:"N/A" }}</div>
              </div>
            </div>

            <div class="analysis-section">
              <div class="analysis-title">
                <i class="fas fa-brain"></i>
                Analyse IA
              </div>
              <div class="analysis-content">
                {{ personne.analyse_llm|default:"Aucune analyse disponible pour le moment. L'intelligence artificielle n'a pas encore trait√© ce profil. Veuillez attendre que l'analyse soit effectu√©e ou contactez l'administrateur si le probl√®me persiste." }}
              </div>
            </div>

            <div class="action-buttons">
              {% if not personne.validated_by_admin %}
                <button class="btn-action btn-validate" 
                        onclick="openValidationModal('{{ personne.first_name }} {{ personne.last_name }}', {{ personne.id }})">
                  <i class="fas fa-check-circle"></i>
                  Valider
                </button>
                <button class="btn-action btn-reject"
                        onclick="handleRejection({{ personne.id }})">
                  <i class="fas fa-times-circle"></i>
                  Rejeter
                </button>
              {% else %}
                <button class="btn-action btn-validate" disabled>
                  <i class="fas fa-check-double"></i>
                  Valid√©
                </button>
              {% endif %}
            </div>
          </div>
        </div>

        {% if forloop.counter|divisibleby:4 or forloop.last %}
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <!-- Message si aucun r√©sultat -->
    <div class="no-results" id="noResults" style="display: none;">
      <i class="fas fa-search"></i>
      <div>Aucune personne ne correspond aux crit√®res de recherche.</div>
    </div>
  </div>

  <!-- Modal de validation -->
  <div class="modal-overlay" id="validationModal">
    <div class="modal-container">
      <div class="modal-header">
        <button class="close-btn" onclick="closeModal()">&times;</button>
        <div class="modal-header-content">
          <h2 class="modal-title">üéØ Validation de Personne</h2>
          <p class="modal-subtitle">Choisissez la cat√©gorie pour <span id="personName"></span></p>
        </div>
      </div>
      
      <div class="modal-body">
        <form id="validationForm">
          {% csrf_token %}
          <div class="form-group">
            <label class="form-label" for="categorySelect">
              üè∑Ô∏è Cat√©gorie de vuln√©rabilit√©
            </label>
            <select class="form-select" id="categorySelect" required>
              <option value="">S√©lectionner une cat√©gorie...</option>
              <option value="orphelin">üßí Orphelin</option>
              <option value="veuve">üë© Veuve</option>
              <option value="handicape">‚ôø Personne handicap√©e</option>
              <option value="senior">üë¥ Personne √¢g√©e</option>
              <option value="refugie">üè† R√©fugi√©</option>
              <option value="sans_abri">üèöÔ∏è Sans-abri</option>
              <option value="famille_nombreuse">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Famille nombreuse</option>
              <option value="chomeur">üíº Ch√¥meur longue dur√©e</option>
              <option value="malade_chronique">üè• Malade chronique</option>
              <option value="etudiant_precaire">üéì √âtudiant en pr√©carit√©</option>
            </select>
          </div>

          <div class="modal-actions">
            <button type="button" class="btn btn-secondary" onclick="closeModal()">
              ‚ùå Annuler
            </button>
            <button type="submit" class="btn btn-primary" id="validateBtn">
              ‚úÖ Valider la personne
            </button>
          </div>
        </form>

        <div class="success-message" id="successMessage">
          <h4>üéâ Validation r√©ussie !</h4>
          <p>La personne a √©t√© valid√©e et ajout√©e √† l'interface de don.</p>
          <p><strong>Identifiants g√©n√©r√©s :</strong></p>
          <p>üë§ Nom d'utilisateur : <span id="generatedUsername"></span></p>
          <p>üîë Mot de passe : <span id="generatedPassword"></span></p>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Variables globales
    let processedCards = new Set();
    let allCards = [];
    let totalCards = 0;
    let validatedCards = 0;
    let rejectedCards = 0;
    let pendingCards = 0;
    let currentPersonId = null;
    let currentPersonName = null;

    // Syst√®me de particules flottantes
    function createParticles() {
      const particlesContainer = document.getElementById('particles');
      const particleCount = 15;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.width = particle.style.height = Math.random() * 15 + 8 + 'px';
        particle.style.animationDelay = Math.random() * 15 + 's';
        particle.style.animationDuration = (Math.random() * 8 + 12) + 's';
        particlesContainer.appendChild(particle);
      }
    }

    // Mise √† jour des statistiques
    function updateStats() {
      document.getElementById('totalCount').textContent = totalCards;
      document.getElementById('validatedCount').textContent = validatedCards;
      document.getElementById('rejectedCount').textContent = rejectedCards;
      document.getElementById('pendingCount').textContent = pendingCards;
    }

    // Ouvrir la modal de validation
    function openValidationModal(personName, personId) {
      if (processedCards.has(personId)) {
        return;
      }

      currentPersonId = personId;
      currentPersonName = personName;
      
      document.getElementById('personName').textContent = personName;
      document.getElementById('validationModal').classList.add('active');
      document.body.style.overflow = 'hidden';
      
      // Reset form
      document.getElementById('validationForm').reset();
      document.getElementById('successMessage').classList.remove('show');
      document.getElementById('validateBtn').classList.remove('loading');
      document.getElementById('validationForm').style.display = 'block';
    }

    // Fermer la modal
    function closeModal() {
      document.getElementById('validationModal').classList.remove('active');
      document.body.style.overflow = 'auto';
      currentPersonId = null;
      currentPersonName = null;
    }

    // G√©rer la soumission du formulaire de validation
    // Dans admin_personnes_carousel.html
document.getElementById('validationForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const category = document.getElementById('categorySelect').value;
    if (!category) {
        showNotification('Veuillez s√©lectionner une cat√©gorie', 'error');
        return;
    }

    const validateBtn = document.getElementById('validateBtn');
    validateBtn.classList.add('loading');

    // R√©cup√©rer le token CSRF
    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
    
    console.log('Sending request to:', `/users/valider_personne/${currentPersonId}/`);
    console.log('Category selected:', category);
    console.log('CSRF Token:', csrfToken);

    // Appel AJAX vers Django
    fetch(`/users/valider_personne/${currentPersonId}/`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': csrfToken,
            'X-Requested-With': 'XMLHttpRequest'
        },
        body: JSON.stringify({
            category: category
        })
    })
    .then(response => {
        console.log('Response status:', response.status);
        console.log('Response headers:', response.headers);
        
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        return response.json();
    })
    .then(data => {
        console.log('Response data:', data);
        
        if (data.success) {
            // Afficher les identifiants g√©n√©r√©s
            document.getElementById('generatedUsername').textContent = data.username;
            document.getElementById('generatedPassword').textContent = data.password;
            document.getElementById('successMessage').classList.add('show');
            document.getElementById('validationForm').style.display = 'none';
            
            // Mettre √† jour l'interface
            updateCardAfterValidation(currentPersonId, 'validated');
            
            // Fermer la modal apr√®s 5 secondes
            setTimeout(() => {
                closeModal();
            }, 5000);
        } else {
            showNotification('Erreur: ' + (data.error || 'Une erreur est survenue'), 'error');
        }
    })
    .catch(error => {
        console.error('Erreur compl√®te:', error);
        showNotification('Une erreur est survenue lors de la validation: ' + error.message, 'error');
    })
    .finally(() => {
        validateBtn.classList.remove('loading');
    });
});

    // Mettre √† jour la carte apr√®s validation/rejet
    function updateCardAfterValidation(personId, action) {
      const card = document.querySelector(`[data-person-id="${personId}"]`);
      const statusBadge = document.getElementById(`status-${personId}`);
      const buttons = card.querySelectorAll('.btn-action');

      if (!card || processedCards.has(personId)) {
        return;
      }

      // Marquer comme trait√©
      processedCards.add(personId);
      
      // Mettre √† jour les statistiques
      pendingCards--;
      
      if (action === 'validated') {
        card.classList.add('validated');
        card.setAttribute('data-status', 'validated');
        statusBadge.classList.add('validated');
        statusBadge.innerHTML = '<i class="fas fa-check"></i>';
        validatedCards++;
        
        // Animation de succ√®s
        card.style.animation = 'pulse 0.6s ease-in-out';
        createCelebrationParticles(card);
        
        // Mettre √† jour les boutons
        buttons.forEach(btn => {
          if (btn.classList.contains('btn-validate')) {
            btn.innerHTML = '<i class="fas fa-check-double"></i> Valid√©';
            btn.disabled = true;
          } else {
            btn.style.display = 'none';
          }
        });
        
      } else if (action === 'rejected') {
        card.classList.add('rejected');
        card.setAttribute('data-status', 'rejected');
        statusBadge.classList.add('rejected');
        statusBadge.innerHTML = '<i class="fas fa-times"></i>';
        rejectedCards++;
        
        // Animation de rejet
        card.style.filter = 'grayscale(0.2)';
        
        // Mettre √† jour les boutons
        buttons.forEach(btn => {
          btn.disabled = true;
          btn.style.opacity = '0.5';
          if (btn.classList.contains('btn-reject')) {
            btn.innerHTML = '<i class="fas fa-ban"></i> Rejet√©';
          }
        });
      }

      // Mettre √† jour les statistiques
      updateStats();
      
      // Appliquer les filtres actuels
      applyFilters();
    }

    // G√©rer le rejet
    function handleRejection(personId) {
      if (processedCards.has(personId)) {
        return;
      }

      if (confirm('√ätes-vous s√ªr de vouloir rejeter cette personne ?')) {
        const loadingOverlay = document.getElementById('loadingOverlay');
        loadingOverlay.style.display = 'flex';

        // Appel vers l'URL de rejet
        fetch(`/users/rejeter_personne/${personId}/`, {
          method: 'POST',
          headers: {
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
          }
        })
        .then(response => {
          if (response.ok) {
            updateCardAfterValidation(personId, 'rejected');
            showNotification('Personne rejet√©e avec succ√®s', 'reject');
          } else {
            showNotification('Erreur lors du rejet', 'error');
          }
        })
        .catch(error => {
          console.error('Erreur:', error);
          showNotification('Une erreur est survenue', 'error');
        })
        .finally(() => {
          loadingOverlay.style.display = 'none';
        });
      }
    }

    // Gestion des filtres
    function applyFilters() {
      const nameFilter = document.getElementById('nameFilter').value.toLowerCase().trim();
      const statusFilter = document.getElementById('statusFilter').value;
      
      let visibleCount = 0;
      
      allCards.forEach(card => {
        const cardName = card.getAttribute('data-name');
        const cardStatus = card.getAttribute('data-status');
        
        let nameMatch = !nameFilter || cardName.includes(nameFilter);
        let statusMatch = statusFilter === 'all' || cardStatus === statusFilter;
        
        if (nameMatch && statusMatch) {
          card.parentElement.style.display = 'block';
          visibleCount++;
        } else {
          card.parentElement.style.display = 'none';
        }
      });
      
      // Afficher/masquer le message "aucun r√©sultat"
      const noResults = document.getElementById('noResults');
      if (visibleCount === 0) {
        noResults.style.display = 'block';
      } else {
        noResults.style.display = 'none';
      }
    }

    function resetFilters() {
      document.getElementById('nameFilter').value = '';
      document.getElementById('statusFilter').value = 'all';
      
      allCards.forEach(card => {
        card.parentElement.style.display = 'block';
      });
      
      document.getElementById('noResults').style.display = 'none';
    }

    // Filtrage en temps r√©el sur le nom
    document.getElementById('nameFilter').addEventListener('input', function() {
      clearTimeout(this.searchTimeout);
      this.searchTimeout = setTimeout(() => {
        applyFilters();
      }, 300);
    });

    document.getElementById('statusFilter').addEventListener('change', function() {
      applyFilters();
    });

    // Particules de c√©l√©bration
    function createCelebrationParticles(card) {
      const rect = card.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;

      for (let i = 0; i < 10; i++) {
        const particle = document.createElement('div');
        particle.style.position = 'fixed';
        particle.style.left = centerX + 'px';
        particle.style.top = centerY + 'px';
        particle.style.width = '6px';
        particle.style.height = '6px';
        particle.style.background = '#10b981';
        particle.style.borderRadius = '50%';
        particle.style.pointerEvents = 'none';
        particle.style.zIndex = '9999';
        
        const angle = (i / 10) * Math.PI * 2;
        const velocity = 80;
        const vx = Math.cos(angle) * velocity;
        const vy = Math.sin(angle) * velocity;
        
        document.body.appendChild(particle);
        
        let startTime = Date.now();
        function animateParticle() {
          const elapsed = Date.now() - startTime;
          const progress = elapsed / 1000;
          
          if (progress < 1) {
            const x = centerX + vx * progress;
            const y = centerY + vy * progress - 0.5 * 150 * progress * progress;
            const opacity = 1 - progress;
            
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.opacity = opacity;
            
            requestAnimationFrame(animateParticle);
          } else {
            document.body.removeChild(particle);
          }
        }
        animateParticle();
      }
    }

    // Syst√®me de notifications
    function showNotification(message, type) {
      // Supprimer les notifications existantes
      const existingNotifications = document.querySelectorAll('.notification-toast');
      existingNotifications.forEach(notif => notif.remove());

      const notification = document.createElement('div');
      notification.className = 'notification-toast';
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 1rem 2rem;
        background: ${getNotificationColor(type)};
        color: white;
        border-radius: 25px;
        font-weight: 600;
        z-index: 10000;
        transform: translateX(400px);
        transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        font-size: 0.9rem;
        max-width: 300px;
      `;
      notification.innerHTML = `<i class="fas fa-${getNotificationIcon(type)} me-2"></i>${message}`;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 100);
      
      setTimeout(() => {
        notification.style.transform = 'translateX(400px)';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 500);
      }, 4000);
    }

    function getNotificationColor(type) {
      switch(type) {
        case 'validate': return 'linear-gradient(135deg, #10b981, #059669)';
        case 'reject': return 'linear-gradient(135deg, #ef4444, #dc2626)';
        case 'error': return 'linear-gradient(135deg, #f59e0b, #d97706)';
        default: return 'linear-gradient(135deg, #667eea, #764ba2)';
      }
    }

    function getNotificationIcon(type) {
      switch(type) {
        case 'validate': return 'check';
        case 'reject': return 'times';
        case 'error': return 'exclamation-triangle';
        default: return 'info';
      }
    }

    // Initialisation
    document.addEventListener('DOMContentLoaded', function() {
      createParticles();
      
      // R√©cup√©rer toutes les cartes
      allCards = Array.from(document.querySelectorAll('.profile-card'));
      totalCards = allCards.length;
      
      // Compter les statuts existants
      allCards.forEach(card => {
        const status = card.getAttribute('data-status');
        if (status === 'validated') {
          validatedCards++;
          processedCards.add(parseInt(card.getAttribute('data-person-id')));
        } else if (status === 'rejected') {
          rejectedCards++;
          processedCards.add(parseInt(card.getAttribute('data-person-id')));
        } else {
          pendingCards++;
        }
      });
      
      // Initialiser les statistiques
      updateStats();
      
      // Animation d'entr√©e des cartes
      allCards.forEach((card, index) => {
        card.style.opacity = '0';
        const dataIndex = parseInt(card.getAttribute('data-index')) || index;
        setTimeout(() => {
          card.style.opacity = '1';
          card.classList.add('card-enter');
          card.style.animationDelay = (dataIndex * 0.05) + 's';
        }, dataIndex * 50);
      });

      // Gestion du raccourci clavier pour la recherche
      document.getElementById('nameFilter').addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          applyFilters();
        }
      });
    });

    // Fermer la modal avec Escape
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeModal();
      }
    });

    // Fermer en cliquant sur l'overlay
    document.getElementById('validationModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    // Effet parallax l√©ger au scroll
    window.addEventListener('scroll', () => {
      const scrolled = window.pageYOffset;
      const particles = document.querySelectorAll('.particle');
      particles.forEach((particle, index) => {
        const speed = 0.3 + (index % 3) * 0.1;
        particle.style.transform = `translateY(${scrolled * speed}px)`;
      });
    });

    // Raccourcis clavier
    document.addEventListener('keydown', function(e) {
      // Ctrl/Cmd + F pour focus sur la recherche
      if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
        e.preventDefault();
        document.getElementById('nameFilter').focus();
      }
      
      // Escape pour reset les filtres
      if (e.key === 'Escape' && !document.getElementById('validationModal').classList.contains('active')) {
        resetFilters();
        document.getElementById('nameFilter').blur();
      }
    });

    // Gestion du focus pour une meilleure UX
    document.getElementById('nameFilter').addEventListener('focus', function() {
      this.style.boxShadow = '0 0 0 0.25rem rgba(103, 126, 234, 0.25)';
    });

    document.getElementById('nameFilter').addEventListener('blur', function() {
      this.style.boxShadow = '';
    });
  </script>
</body>
</html>







{#{% load static %}#}
{#<!DOCTYPE html>#}
{#<html lang="fr">#}
{#<head>#}
{#  <meta charset="UTF-8" />#}
{#  <meta name="viewport" content="width=device-width, initial-scale=1.0" />#}
{#  <title>Liste des personnes recens√©es</title>#}
{#  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />#}
{#  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />#}
{#  <style>#}
{#    :root {#}
{#      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);#}
{#      --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);#}
{#      --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);#}
{#      --warning-gradient: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);#}
{#      --card-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);#}
{#      --card-hover-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);#}
{#      --text-primary: #2c3e50;#}
{#      --text-secondary: #718096;#}
{#      --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);#}
{#    }#}
{##}
{#    * {#}
{#      margin: 0;#}
{#      padding: 0;#}
{#      box-sizing: border-box;#}
{#    }#}
{##}
{#    body {#}
{#      background: var(--bg-gradient);#}
{#      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;#}
{#      min-height: 100vh;#}
{#      color: var(--text-primary);#}
{#      overflow-x: hidden;#}
{#    }#}
{##}
{#    .container {#}
{#      max-width: 1600px;#}
{#      position: relative;#}
{#    }#}
{##}
{#    .header-section {#}
{#      text-align: center;#}
{#      margin-bottom: 3rem;#}
{#      position: relative;#}
{#    }#}
{##}
{#    .header-title {#}
{#      font-size: 3rem;#}
{#      font-weight: 800;#}
{#      background: var(--primary-gradient);#}
{#      -webkit-background-clip: text;#}
{#      -webkit-text-fill-color: transparent;#}
{#      background-clip: text;#}
{#      margin-bottom: 1rem;#}
{#      animation: fadeInUp 1s ease-out;#}
{#    }#}
{##}
{#    .header-subtitle {#}
{#      font-size: 1.1rem;#}
{#      color: var(--text-secondary);#}
{#      font-weight: 300;#}
{#      animation: fadeInUp 1s ease-out 0.2s both;#}
{#    }#}
{##}
{#    /* Statistiques Dashboard */#}
{#    .stats-dashboard {#}
{#      display: grid;#}
{#      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));#}
{#      gap: 1.5rem;#}
{#      margin-bottom: 2rem;#}
{#      animation: fadeInUp 1s ease-out 0.4s both;#}
{#    }#}
{##}
{#    .stat-card {#}
{#      background: rgba(255, 255, 255, 0.95);#}
{#      backdrop-filter: blur(20px);#}
{#      border-radius: 16px;#}
{#      padding: 1.5rem;#}
{#      text-align: center;#}
{#      box-shadow: var(--card-shadow);#}
{#      transition: all 0.3s ease;#}
{#      border: 1px solid rgba(255, 255, 255, 0.2);#}
{#    }#}
{##}
{#    .stat-card:hover {#}
{#      transform: translateY(-5px);#}
{#      box-shadow: var(--card-hover-shadow);#}
{#    }#}
{##}
{#    .stat-icon {#}
{#      font-size: 2.5rem;#}
{#      margin-bottom: 1rem;#}
{#      display: block;#}
{#    }#}
{##}
{#    .stat-card.total .stat-icon { color: #667eea; }#}
{#    .stat-card.validated .stat-icon { color: #10b981; }#}
{#    .stat-card.rejected .stat-icon { color: #ef4444; }#}
{#    .stat-card.pending .stat-icon { color: #f59e0b; }#}
{##}
{#    .stat-number {#}
{#      font-size: 2rem;#}
{#      font-weight: 800;#}
{#      margin-bottom: 0.5rem;#}
{#    }#}
{##}
{#    .stat-label {#}
{#      font-size: 0.9rem;#}
{#      color: var(--text-secondary);#}
{#      font-weight: 600;#}
{#      text-transform: uppercase;#}
{#      letter-spacing: 0.5px;#}
{#    }#}
{##}
{#    /* Filtres */#}
{#    .filters-section {#}
{#      background: rgba(255, 255, 255, 0.95);#}
{#      backdrop-filter: blur(20px);#}
{#      border-radius: 16px;#}
{#      padding: 1.5rem;#}
{#      margin-bottom: 2rem;#}
{#      box-shadow: var(--card-shadow);#}
{#      animation: fadeInUp 1s ease-out 0.6s both;#}
{#    }#}
{##}
{#    .filters-grid {#}
{#      display: grid;#}
{#      grid-template-columns: 1fr auto auto auto;#}
{#      gap: 1rem;#}
{#      align-items: end;#}
{#    }#}
{##}
{#    .filter-group {#}
{#      display: flex;#}
{#      flex-direction: column;#}
{#      gap: 0.5rem;#}
{#    }#}
{##}
{#    .filter-label {#}
{#      font-size: 0.9rem;#}
{#      font-weight: 600;#}
{#      color: var(--text-secondary);#}
{#      text-transform: uppercase;#}
{#      letter-spacing: 0.5px;#}
{#    }#}
{##}
{#    .form-control, .form-select {#}
{#      border-radius: 12px;#}
{#      border: 2px solid rgba(103, 126, 234, 0.1);#}
{#      padding: 0.75rem 1rem;#}
{#      transition: all 0.3s ease;#}
{#      background: rgba(255, 255, 255, 0.8);#}
{#    }#}
{##}
{#    .form-control:focus, .form-select:focus {#}
{#      border-color: #667eea;#}
{#      box-shadow: 0 0 0 0.2rem rgba(103, 126, 234, 0.25);#}
{#      background: white;#}
{#    }#}
{##}
{#    .btn-filter {#}
{#      padding: 0.75rem 1.5rem;#}
{#      border-radius: 12px;#}
{#      font-weight: 600;#}
{#      transition: all 0.3s ease;#}
{#      border: none;#}
{#      text-transform: uppercase;#}
{#      letter-spacing: 0.5px;#}
{#    }#}
{##}
{#    .btn-primary {#}
{#      background: var(--primary-gradient);#}
{#      color: white;#}
{#      box-shadow: 0 5px 15px rgba(103, 126, 234, 0.4);#}
{#    }#}
{##}
{#    .btn-primary:hover {#}
{#      transform: translateY(-2px);#}
{#      box-shadow: 0 8px 20px rgba(103, 126, 234, 0.6);#}
{#    }#}
{##}
{#    .btn-secondary {#}
{#      background: #6c757d;#}
{#      color: white;#}
{#    }#}
{##}
{#    .btn-secondary:hover {#}
{#      background: #5a6268;#}
{#      transform: translateY(-2px);#}
{#    }#}
{##}
{#    /* Cartes de profil - plus compactes */#}
{#    .profile-card {#}
{#      background: rgba(255, 255, 255, 0.95);#}
{#      backdrop-filter: blur(20px);#}
{#      border-radius: 16px;#}
{#      box-shadow: var(--card-shadow);#}
{#      padding: 1.5rem;#}
{#      margin-bottom: 1.5rem;#}
{#      position: relative;#}
{#      overflow: hidden;#}
{#      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);#}
{#      transform: translateY(0);#}
{#      border: 1px solid rgba(255, 255, 255, 0.2);#}
{#      height: fit-content;#}
{#    }#}
{##}
{#    .profile-card::before {#}
{#      content: '';#}
{#      position: absolute;#}
{#      top: 0;#}
{#      left: -100%;#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);#}
{#      transition: left 0.8s;#}
{#    }#}
{##}
{#    .profile-card:hover::before {#}
{#      left: 100%;#}
{#    }#}
{##}
{#    .profile-card:hover {#}
{#      transform: translateY(-5px) scale(1.01);#}
{#      box-shadow: var(--card-hover-shadow);#}
{#    }#}
{##}
{#    .profile-card.validated {#}
{#      border: 2px solid #10b981;#}
{#      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);#}
{#    }#}
{##}
{#    .profile-card.rejected {#}
{#      border: 2px solid #ef4444;#}
{#      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);#}
{#    }#}
{##}
{#    .profile-card.hidden {#}
{#      display: none;#}
{#    }#}
{##}
{#    /* Avatar plus compact */#}
{#    .avatar-container {#}
{#      position: relative;#}
{#      margin: 0 auto 1rem;#}
{#      width: 80px;#}
{#      height: 80px;#}
{#    }#}
{##}
{#    .avatar {#}
{#      width: 80px;#}
{#      height: 80px;#}
{#      border-radius: 50%;#}
{#      border: 3px solid transparent;#}
{#      background: var(--primary-gradient);#}
{#      padding: 3px;#}
{#      object-fit: cover;#}
{#      transition: all 0.3s ease;#}
{#    }#}
{##}
{#    .avatar-inner {#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      border-radius: 50%;#}
{#      object-fit: cover;#}
{#    }#}
{##}
{#    .status-badge {#}
{#      position: absolute;#}
{#      top: -5px;#}
{#      right: -5px;#}
{#      width: 30px;#}
{#      height: 30px;#}
{#      border-radius: 50%;#}
{#      display: flex;#}
{#      align-items: center;#}
{#      justify-content: center;#}
{#      font-size: 1rem;#}
{#      color: white;#}
{#      opacity: 0;#}
{#      transform: scale(0);#}
{#      transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);#}
{#    }#}
{##}
{#    .status-badge.validated {#}
{#      background: linear-gradient(135deg, #10b981, #059669);#}
{#      opacity: 1;#}
{#      transform: scale(1);#}
{#    }#}
{##}
{#    .status-badge.rejected {#}
{#      background: linear-gradient(135deg, #ef4444, #dc2626);#}
{#      opacity: 1;#}
{#      transform: scale(1);#}
{#    }#}
{##}
{#    .person-name {#}
{#      font-size: 1.3rem;#}
{#      font-weight: 700;#}
{#      margin-bottom: 1rem;#}
{#      background: var(--primary-gradient);#}
{#      -webkit-background-clip: text;#}
{#      -webkit-text-fill-color: transparent;#}
{#      background-clip: text;#}
{#      text-align: center;#}
{#    }#}
{##}
{#    /* Grille d'informations plus compacte */#}
{#    .info-grid {#}
{#      display: grid;#}
{#      grid-template-columns: 1fr 1fr;#}
{#      gap: 0.8rem;#}
{#      margin-bottom: 1rem;#}
{#    }#}
{##}
{#    .info-item {#}
{#      background: rgba(103, 126, 234, 0.05);#}
{#      padding: 0.8rem;#}
{#      border-radius: 12px;#}
{#      border-left: 3px solid var(--primary-gradient);#}
{#      transition: all 0.3s ease;#}
{#    }#}
{##}
{#    .info-item:hover {#}
{#      transform: translateX(3px);#}
{#      background: rgba(103, 126, 234, 0.1);#}
{#    }#}
{##}
{#    .info-label {#}
{#      font-size: 0.8rem;#}
{#      font-weight: 600;#}
{#      color: var(--text-secondary);#}
{#      margin-bottom: 0.3rem;#}
{#      text-transform: uppercase;#}
{#      letter-spacing: 0.5px;#}
{#    }#}
{##}
{#    .info-value {#}
{#      font-size: 0.95rem;#}
{#      font-weight: 600;#}
{#      color: var(--text-primary);#}
{#    }#}
{##}
{#    .info-item-full {#}
{#      grid-column: 1 / -1;#}
{#    }#}
{##}
{#    /* Section d'analyse IA agrandie */#}
{#    .analysis-section {#}
{#      background: rgba(103, 126, 234, 0.05);#}
{#      padding: 1.2rem;#}
{#      border-radius: 12px;#}
{#      margin-bottom: 1.5rem;#}
{#      border: 1px solid rgba(103, 126, 234, 0.1);#}
{#    }#}
{##}
{#    .analysis-title {#}
{#      font-size: 1rem;#}
{#      font-weight: 600;#}
{#      color: var(--text-primary);#}
{#      margin-bottom: 0.8rem;#}
{#      display: flex;#}
{#      align-items: center;#}
{#      gap: 0.5rem;#}
{#    }#}
{##}
{#    .analysis-content {#}
{#      max-height: 200px; /* Augment√© de 120px √† 200px */#}
{#      overflow-y: auto;#}
{#      font-size: 0.9rem;#}
{#      line-height: 1.5;#}
{#      color: var(--text-secondary);#}
{#      scrollbar-width: thin;#}
{#      scrollbar-color: rgba(103, 126, 234, 0.3) transparent;#}
{#      padding-right: 0.5rem;#}
{#    }#}
{##}
{#    .analysis-content::-webkit-scrollbar {#}
{#      width: 6px;#}
{#    }#}
{##}
{#    .analysis-content::-webkit-scrollbar-thumb {#}
{#      background: rgba(103, 126, 234, 0.3);#}
{#      border-radius: 3px;#}
{#    }#}
{##}
{#    /* Boutons d'action plus compacts */#}
{#    .action-buttons {#}
{#      display: flex;#}
{#      gap: 0.8rem;#}
{#      justify-content: center;#}
{#    }#}
{##}
{#    .btn-action {#}
{#      padding: 0.7rem 1.5rem;#}
{#      border-radius: 25px;#}
{#      font-weight: 600;#}
{#      font-size: 0.85rem;#}
{#      text-decoration: none;#}
{#      display: inline-flex;#}
{#      align-items: center;#}
{#      gap: 0.5rem;#}
{#      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);#}
{#      position: relative;#}
{#      overflow: hidden;#}
{#      text-transform: uppercase;#}
{#      letter-spacing: 0.3px;#}
{#    }#}
{##}
{#    .btn-action::before {#}
{#      content: '';#}
{#      position: absolute;#}
{#      top: 0;#}
{#      left: -100%;#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);#}
{#      transition: left 0.5s;#}
{#    }#}
{##}
{#    .btn-action:hover::before {#}
{#      left: 100%;#}
{#    }#}
{##}
{#    .btn-validate {#}
{#      background: var(--success-gradient);#}
{#      color: white;#}
{#      border: none;#}
{#      box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);#}
{#    }#}
{##}
{#    .btn-validate:hover {#}
{#      transform: translateY(-2px) scale(1.03);#}
{#      box-shadow: 0 8px 20px rgba(79, 172, 254, 0.5);#}
{#      color: white;#}
{#    }#}
{##}
{#    .btn-reject {#}
{#      background: var(--danger-gradient);#}
{#      color: white;#}
{#      border: none;#}
{#      box-shadow: 0 5px 15px rgba(250, 112, 154, 0.3);#}
{#    }#}
{##}
{#    .btn-reject:hover {#}
{#      transform: translateY(-2px) scale(1.03);#}
{#      box-shadow: 0 8px 20px rgba(250, 112, 154, 0.5);#}
{#      color: white;#}
{#    }#}
{##}
{#    .btn-action:disabled {#}
{#      opacity: 0.6;#}
{#      cursor: not-allowed;#}
{#      transform: none !important;#}
{#    }#}
{##}
{#    /* Particules flottantes */#}
{#    .floating-particles {#}
{#      position: fixed;#}
{#      top: 0;#}
{#      left: 0;#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      pointer-events: none;#}
{#      z-index: -1;#}
{#    }#}
{##}
{#    .particle {#}
{#      position: absolute;#}
{#      background: rgba(103, 126, 234, 0.1);#}
{#      border-radius: 50%;#}
{#      animation: float-particle 15s infinite linear;#}
{#    }#}
{##}
{#    .loading-overlay {#}
{#      position: fixed;#}
{#      top: 0;#}
{#      left: 0;#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      background: rgba(255, 255, 255, 0.9);#}
{#      backdrop-filter: blur(10px);#}
{#      display: none;#}
{#      align-items: center;#}
{#      justify-content: center;#}
{#      z-index: 9999;#}
{#    }#}
{##}
{#    .loader {#}
{#      width: 60px;#}
{#      height: 60px;#}
{#      border: 4px solid rgba(103, 126, 234, 0.2);#}
{#      border-top: 4px solid #667eea;#}
{#      border-radius: 50%;#}
{#      animation: spin 1s linear infinite;#}
{#    }#}
{##}
{#    .no-results {#}
{#      text-align: center;#}
{#      padding: 3rem;#}
{#      color: var(--text-secondary);#}
{#      font-size: 1.1rem;#}
{#    }#}
{##}
{#    .no-results i {#}
{#      font-size: 4rem;#}
{#      margin-bottom: 1rem;#}
{#      color: rgba(103, 126, 234, 0.3);#}
{#    }#}
{##}
{#    /* Animations */#}
{#    @keyframes fadeInUp {#}
{#      from {#}
{#        opacity: 0;#}
{#        transform: translateY(50px);#}
{#      }#}
{#      to {#}
{#        opacity: 1;#}
{#        transform: translateY(0);#}
{#      }#}
{#    }#}
{##}
{#    @keyframes float {#}
{#      0%, 100% { transform: translateY(0px); }#}
{#      50% { transform: translateY(-10px); }#}
{#    }#}
{##}
{#    @keyframes float-particle {#}
{#      0% {#}
{#        transform: translateY(100vh) rotate(0deg);#}
{#        opacity: 0;#}
{#      }#}
{#      10% {#}
{#        opacity: 1;#}
{#      }#}
{#      90% {#}
{#        opacity: 1;#}
{#      }#}
{#      100% {#}
{#        transform: translateY(-100vh) rotate(360deg);#}
{#        opacity: 0;#}
{#      }#}
{#    }#}
{##}
{#    @keyframes spin {#}
{#      0% { transform: rotate(0deg); }#}
{#      100% { transform: rotate(360deg); }#}
{#    }#}
{##}
{#    @keyframes pulse {#}
{#      0%, 100% { transform: scale(1); }#}
{#      50% { transform: scale(1.05); }#}
{#    }#}
{##}
{#    .card-enter {#}
{#      animation: cardEnter 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);#}
{#    }#}
{##}
{#    @keyframes cardEnter {#}
{#      from {#}
{#        opacity: 0;#}
{#        transform: translateY(30px) scale(0.95);#}
{#      }#}
{#      to {#}
{#        opacity: 1;#}
{#        transform: translateY(0) scale(1);#}
{#      }#}
{#    }#}
{##}
{#    /* Responsive */#}
{#    @media (max-width: 1200px) {#}
{#      .filters-grid {#}
{#        grid-template-columns: 1fr;#}
{#        gap: 1rem;#}
{#      }#}
{#      #}
{#      .filters-grid .filter-group:last-child {#}
{#        grid-column: 1;#}
{#        display: flex;#}
{#        flex-direction: row;#}
{#        gap: 1rem;#}
{#      }#}
{#    }#}
{##}
{#    @media (max-width: 768px) {#}
{#      .header-title {#}
{#        font-size: 2.2rem;#}
{#      }#}
{#      #}
{#      .stats-dashboard {#}
{#        grid-template-columns: repeat(2, 1fr);#}
{#      }#}
{#      #}
{#      .info-grid {#}
{#        grid-template-columns: 1fr;#}
{#      }#}
{#      #}
{#      .action-buttons {#}
{#        flex-direction: column;#}
{#      }#}
{#      #}
{#      .btn-action {#}
{#        justify-content: center;#}
{#      }#}
{#    }#}
{##}
{#    @media (max-width: 576px) {#}
{#      .stats-dashboard {#}
{#        grid-template-columns: 1fr;#}
{#      }#}
{#    }#}
{#  </style>#}
{#</head>#}
{#<body>#}
{#  <div class="floating-particles" id="particles"></div>#}
{#  #}
{#  <div class="loading-overlay" id="loadingOverlay">#}
{#    <div class="loader"></div>#}
{#  </div>#}
{##}
{#  <div class="container my-4">#}
{#    <div class="header-section">#}
{#      <h1 class="header-title">#}
{#        <i class="fas fa-users me-3"></i>#}
{#        Analyse des Recensements#}
{#      </h1>#}
{#      <p class="header-subtitle">Validation et traitement des donn√©es collect√©es</p>#}
{#    </div>#}
{##}
{#    <!-- Dashboard des statistiques -->#}
{#    <div class="stats-dashboard">#}
{#      <div class="stat-card total">#}
{#        <i class="fas fa-users stat-icon"></i>#}
{#        <div class="stat-number" id="totalCount">{{ personnes|length }}</div>#}
{#        <div class="stat-label">Total</div>#}
{#      </div>#}
{#      <div class="stat-card validated">#}
{#        <i class="fas fa-check-circle stat-icon"></i>#}
{#        <div class="stat-number" id="validatedCount">0</div>#}
{#        <div class="stat-label">Valid√©es</div>#}
{#      </div>#}
{#      <div class="stat-card rejected">#}
{#        <i class="fas fa-times-circle stat-icon"></i>#}
{#        <div class="stat-number" id="rejectedCount">0</div>#}
{#        <div class="stat-label">Rejet√©es</div>#}
{#      </div>#}
{#      <div class="stat-card pending">#}
{#        <i class="fas fa-clock stat-icon"></i>#}
{#        <div class="stat-number" id="pendingCount">{{ personnes|length }}</div>#}
{#        <div class="stat-label">En attente</div>#}
{#      </div>#}
{#    </div>#}
{##}
{#    <!-- Section des filtres -->#}
{#    <div class="filters-section">#}
{#      <div class="filters-grid">#}
{#        <div class="filter-group">#}
{#          <label class="filter-label">Recherche par nom</label>#}
{#          <input type="text" class="form-control" id="nameFilter" placeholder="Rechercher une personne...">#}
{#        </div>#}
{#        <div class="filter-group">#}
{#          <label class="filter-label">Statut</label>#}
{#          <select class="form-select" id="statusFilter">#}
{#            <option value="all">Tous les statuts</option>#}
{#            <option value="pending">En attente</option>#}
{#            <option value="validated">Valid√©es</option>#}
{#            <option value="rejected">Rejet√©es</option>#}
{#          </select>#}
{#        </div>#}
{#        <div class="filter-group">#}
{#          <label class="filter-label">&nbsp;</label>#}
{#          <button type="button" class="btn btn-primary btn-filter" onclick="applyFilters()">#}
{#            <i class="fas fa-filter me-2"></i>Filtrer#}
{#          </button>#}
{#        </div>#}
{#        <div class="filter-group">#}
{#          <label class="filter-label">&nbsp;</label>#}
{#          <button type="button" class="btn btn-secondary btn-filter" onclick="resetFilters()">#}
{#            <i class="fas fa-undo me-2"></i>Reset#}
{#          </button>#}
{#        </div>#}
{#      </div>#}
{#    </div>#}
{##}
{#    <!-- Conteneur des cartes -->#}
{#    <div id="cardsContainer">#}
{#      {% for personne in personnes %}#}
{#        {% if forloop.first or forloop.counter0|divisibleby:4 %}#}
{#          <div class="row">#}
{#        {% endif %}#}
{#        #}
{#        <div class="col-xl-3 col-lg-4 col-md-6">#}
{#          <div class="profile-card card-enter" #}
{#               data-person-id="{{ personne.id }}" #}
{#               data-index="{{ forloop.counter0 }}"#}
{#               data-name="{{ personne.first_name|lower }} {{ personne.last_name|lower }}"#}
{#               data-status="pending">#}
{#            #}
{#            <div class="avatar-container">#}
{#              <div class="avatar">#}
{#                {% if personne.photo %}#}
{#                  <img src="{{ personne.photo.url }}" alt="Photo de {{ personne.first_name }}" class="avatar-inner" />#}
{#                {% else %}#}
{#                  <img src="{% static 'images/default_avatar.png' %}" alt="Avatar par d√©faut" class="avatar-inner" />#}
{#                {% endif %}#}
{#              </div>#}
{#              <div class="status-badge" id="status-{{ personne.id }}">#}
{#                <i class="fas fa-check"></i>#}
{#              </div>#}
{#            </div>#}
{##}
{##}
{#            <h3 class="person-name">{{ personne.first_name }} {{ personne.last_name }}</h3>#}
{##}
{#            <div class="info-grid">#}
{#              <div class="info-item">#}
{#                <div class="info-label">#}
{#                  <i class="fas fa-user-tie me-1"></i>#}
{#                  Recenseur#}
{#                </div>#}
{#                <div class="info-value">#}
{#                  {% if personne.recenseur %}{{ personne.recenseur.username }}{% else %}N/A{% endif %}#}
{#                </div>#}
{#              </div>#}
{##}
{#              <div class="info-item">#}
{#                <div class="info-label">#}
{#                  <i class="fas fa-chart-line me-1"></i>#}
{#                  Pauvret√©#}
{#                </div>#}
{#                <div class="info-value">{{ personne.niveau_pauvrete|default:"N/A" }}%</div>#}
{#              </div>#}
{##}
{#              <div class="info-item info-item-full">#}
{#                <div class="info-label">#}
{#                  <i class="fas fa-tag me-1"></i>#}
{#                  Cat√©gorie#}
{#                </div>#}
{#                <div class="info-value">{{ personne.categorie_predite|default:"Non d√©termin√©e" }}</div>#}
{#              </div>#}
{#            </div>#}
{##}
{#            <div class="analysis-section">#}
{#              <div class="analysis-title">#}
{#                <i class="fas fa-brain"></i>#}
{#                Analyse IA#}
{#              </div>#}
{#              <div class="analysis-content">#}
{#                {{ personne.analyse_llm|default:"Aucune analyse disponible pour le moment. L'intelligence artificielle n'a pas encore trait√© ce profil. Veuillez attendre que l'analyse soit effectu√©e ou contactez l'administrateur si le probl√®me persiste." }}#}
{#              </div>#}
{#            </div>#}
{##}
{#            <div class="action-buttons">#}
{#              <a href="{% url 'valider_personne' personne.id %}" #}
{#                 class="btn-action btn-validate" #}
{#                 onclick="handleValidation(event, {{ personne.id }}, 'validate')">#}
{#                <i class="fas fa-check-circle"></i>#}
{#                Valider#}
{#              </a>#}
{#              <a href="{% url 'rejeter_personne' personne.id %}" #}
{#                 class="btn-action btn-reject"#}
{#                 onclick="handleValidation(event, {{ personne.id }}, 'reject')">#}
{#                <i class="fas fa-times-circle"></i>#}
{#                Rejeter#}
{#              </a>#}
{#            </div>#}
{#          </div>#}
{#        </div>#}
{##}
{#        {% if forloop.counter|divisibleby:4 or forloop.last %}#}
{#          </div>#}
{#        {% endif %}#}
{#      {% endfor %}#}
{#    </div>#}
{##}
{#    <!-- Message si aucun r√©sultat -->#}
{#    <div class="no-results" id="noResults" style="display: none;">#}
{#      <i class="fas fa-search"></i>#}
{#      <div>Aucune personne ne correspond aux crit√®res de recherche.</div>#}
{#    </div>#}
{#  </div>#}
{##}
{#  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>#}
{#  <script>#}
{#    // Variables globales#}
{#    let processedCards = new Set();#}
{#    let allCards = [];#}
{#    let totalCards = 0;#}
{#    let validatedCards = 0;#}
{#    let rejectedCards = 0;#}
{#    let pendingCards = 0;#}
{##}
{#    // Syst√®me de particules flottantes#}
{#    function createParticles() {#}
{#      const particlesContainer = document.getElementById('particles');#}
{#      const particleCount = 15;#}
{#      #}
{#      for (let i = 0; i < particleCount; i++) {#}
{#        const particle = document.createElement('div');#}
{#        particle.className = 'particle';#}
{#        particle.style.left = Math.random() * 100 + '%';#}
{#        particle.style.width = particle.style.height = Math.random() * 15 + 8 + 'px';#}
{#        particle.style.animationDelay = Math.random() * 15 + 's';#}
{#        particle.style.animationDuration = (Math.random() * 8 + 12) + 's';#}
{#        particlesContainer.appendChild(particle);#}
{#      }#}
{#    }#}
{##}
{#    // Mise √† jour des statistiques#}
{#    function updateStats() {#}
{#      document.getElementById('totalCount').textContent = totalCards;#}
{#      document.getElementById('validatedCount').textContent = validatedCards;#}
{#      document.getElementById('rejectedCount').textContent = rejectedCards;#}
{#      document.getElementById('pendingCount').textContent = pendingCards;#}
{#    }#}
{##}
{#    // Gestion des filtres#}
{#    function applyFilters() {#}
{#      const nameFilter = document.getElementById('nameFilter').value.toLowerCase().trim();#}
{#      const statusFilter = document.getElementById('statusFilter').value;#}
{#      #}
{#      let visibleCount = 0;#}
{#      #}
{#      allCards.forEach(card => {#}
{#        const cardName = card.getAttribute('data-name');#}
{#        const cardStatus = card.getAttribute('data-status');#}
{#        #}
{#        let nameMatch = !nameFilter || cardName.includes(nameFilter);#}
{#        let statusMatch = statusFilter === 'all' || cardStatus === statusFilter;#}
{#        #}
{#        if (nameMatch && statusMatch) {#}
{#          card.classList.remove('hidden');#}
{#          visibleCount++;#}
{#        } else {#}
{#          card.classList.add('hidden');#}
{#        }#}
{#      });#}
{#      #}
{#      // Afficher/masquer le message "aucun r√©sultat"#}
{#      const noResults = document.getElementById('noResults');#}
{#      if (visibleCount === 0) {#}
{#        noResults.style.display = 'block';#}
{#      } else {#}
{#        noResults.style.display = 'none';#}
{#      }#}
{#    }#}
{##}
{#    function resetFilters() {#}
{#      document.getElementById('nameFilter').value = '';#}
{#      document.getElementById('statusFilter').value = 'all';#}
{#      #}
{#      allCards.forEach(card => {#}
{#        card.classList.remove('hidden');#}
{#      });#}
{#      #}
{#      document.getElementById('noResults').style.display = 'none';#}
{#    }#}
{##}
{#    // Filtrage en temps r√©el sur le nom#}
{#    document.getElementById('nameFilter').addEventListener('input', function() {#}
{#      applyFilters();#}
{#    });#}
{##}
{#    document.getElementById('statusFilter').addEventListener('change', function() {#}
{#      applyFilters();#}
{#    });#}
{##}
{#    // Gestion des validations/rejets#}
{#    function handleValidation(event, personId, action) {#}
{#      event.preventDefault();#}
{#      #}
{#      if (processedCards.has(personId)) {#}
{#        return false;#}
{#      }#}
{##}
{#      const card = document.querySelector(`[data-person-id="${personId}"]`);#}
{#      const statusBadge = document.getElementById(`status-${personId}`);#}
{#      const buttons = card.querySelectorAll('.btn-action');#}
{#      const loadingOverlay = document.getElementById('loadingOverlay');#}
{##}
{#      // Afficher le loader#}
{#      loadingOverlay.style.display = 'flex';#}
{##}
{#      // D√©sactiver les boutons#}
{#      buttons.forEach(btn => {#}
{#        btn.style.pointerEvents = 'none';#}
{#        btn.style.opacity = '0.6';#}
{#      });#}
{##}
{#      // Animation de traitement#}
{#      card.style.transform = 'scale(0.98)';#}
{#      #}
{#      setTimeout(() => {#}
{#        // Masquer le loader#}
{#        loadingOverlay.style.display = 'none';#}
{#        #}
{#        // Marquer comme trait√©#}
{#        processedCards.add(personId);#}
{#        #}
{#        // Mettre √† jour les statistiques#}
{#        pendingCards--;#}
{#        #}
{#        // Appliquer les styles selon l'action#}
{#        if (action === 'validate') {#}
{#          card.classList.add('validated');#}
{#          card.setAttribute('data-status', 'validated');#}
{#          statusBadge.classList.add('validated');#}
{#          statusBadge.innerHTML = '<i class="fas fa-check"></i>';#}
{#          validatedCards++;#}
{#          #}
{#          // Animation de succ√®s#}
{#          card.style.animation = 'pulse 0.6s ease-in-out';#}
{#          #}
{#          // Particules de c√©l√©bration#}
{#          createCelebrationParticles(card);#}
{#          #}
{#        } else if (action === 'reject') {#}
{#          card.classList.add('rejected');#}
{#          card.setAttribute('data-status', 'rejected');#}
{#          statusBadge.classList.add('rejected');#}
{#          statusBadge.innerHTML = '<i class="fas fa-times"></i>';#}
{#          rejectedCards++;#}
{#          #}
{#          // Animation de rejet#}
{#          card.style.filter = 'grayscale(0.2)';#}
{#        }#}
{##}
{#        // Restaurer la transformation#}
{#        card.style.transform = 'translateY(-5px) scale(1.01)';#}
{#        #}
{#        // Mettre √† jour les boutons#}
{#        buttons.forEach(btn => {#}
{#          btn.style.pointerEvents = 'none';#}
{#          btn.style.opacity = '0.5';#}
{#          if (btn.textContent.trim().toLowerCase().includes(action === 'validate' ? 'valider' : 'rejeter')) {#}
{#            btn.innerHTML = action === 'validate' ? #}
{#              '<i class="fas fa-check-double"></i> Valid√©' : #}
{#              '<i class="fas fa-ban"></i> Rejet√©';#}
{#            btn.style.opacity = '1';#}
{#          }#}
{#        });#}
{##}
{#        // Mettre √† jour les statistiques#}
{#        updateStats();#}
{##}
{#        // Notification#}
{#        showNotification(action === 'validate' ? 'Personne valid√©e avec succ√®s!' : 'Personne rejet√©e.', action);#}
{#        #}
{#        // Appliquer les filtres actuels pour mettre √† jour l'affichage#}
{#        applyFilters();#}
{#        #}
{#      }, 1500);#}
{##}
{#      return false;#}
{#    }#}
{##}
{#    // Particules de c√©l√©bration#}
{#    function createCelebrationParticles(card) {#}
{#      const rect = card.getBoundingClientRect();#}
{#      const centerX = rect.left + rect.width / 2;#}
{#      const centerY = rect.top + rect.height / 2;#}
{##}
{#      for (let i = 0; i < 10; i++) {#}
{#        const particle = document.createElement('div');#}
{#        particle.style.position = 'fixed';#}
{#        particle.style.left = centerX + 'px';#}
{#        particle.style.top = centerY + 'px';#}
{#        particle.style.width = '6px';#}
{#        particle.style.height = '6px';#}
{#        particle.style.background = '#10b981';#}
{#        particle.style.borderRadius = '50%';#}
{#        particle.style.pointerEvents = 'none';#}
{#        particle.style.zIndex = '9999';#}
{#        #}
{#        const angle = (i / 10) * Math.PI * 2;#}
{#        const velocity = 80;#}
{#        const vx = Math.cos(angle) * velocity;#}
{#        const vy = Math.sin(angle) * velocity;#}
{#        #}
{#        document.body.appendChild(particle);#}
{#        #}
{#        let startTime = Date.now();#}
{#        function animateParticle() {#}
{#          const elapsed = Date.now() - startTime;#}
{#          const progress = elapsed / 1000;#}
{#          #}
{#          if (progress < 1) {#}
{#            const x = centerX + vx * progress;#}
{#            const y = centerY + vy * progress - 0.5 * 150 * progress * progress;#}
{#            const opacity = 1 - progress;#}
{#            #}
{#            particle.style.left = x + 'px';#}
{#            particle.style.top = y + 'px';#}
{#            particle.style.opacity = opacity;#}
{#            #}
{#            requestAnimationFrame(animateParticle);#}
{#          } else {#}
{#            document.body.removeChild(particle);#}
{#          }#}
{#        }#}
{#        animateParticle();#}
{#      }#}
{#    }#}
{##}
{#    // Syst√®me de notifications#}
{#    function showNotification(message, type) {#}
{#      const notification = document.createElement('div');#}
{#      notification.style.cssText = `#}
{#        position: fixed;#}
{#        top: 20px;#}
{#        right: 20px;#}
{#        padding: 1rem 2rem;#}
{#        background: ${type === 'validate' ? 'linear-gradient(135deg, #10b981, #059669)' : 'linear-gradient(135deg, #ef4444, #dc2626)'};#}
{#        color: white;#}
{#        border-radius: 25px;#}
{#        font-weight: 600;#}
{#        z-index: 10000;#}
{#        transform: translateX(400px);#}
{#        transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);#}
{#        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);#}
{#        font-size: 0.9rem;#}
{#      `;#}
{#      notification.innerHTML = `<i class="fas fa-${type === 'validate' ? 'check' : 'times'} me-2"></i>${message}`;#}
{#      #}
{#      document.body.appendChild(notification);#}
{#      #}
{#      setTimeout(() => {#}
{#        notification.style.transform = 'translateX(0)';#}
{#      }, 100);#}
{#      #}
{#      setTimeout(() => {#}
{#        notification.style.transform = 'translateX(400px)';#}
{#        setTimeout(() => document.body.removeChild(notification), 500);#}
{#      }, 3000);#}
{#    }#}
{##}
{#    // Initialisation#}
{#    document.addEventListener('DOMContentLoaded', function() {#}
{#      createParticles();#}
{#      #}
{#      // R√©cup√©rer toutes les cartes#}
{#      allCards = Array.from(document.querySelectorAll('.profile-card'));#}
{#      totalCards = allCards.length;#}
{#      pendingCards = totalCards;#}
{#      #}
{#      // Initialiser les statistiques#}
{#      updateStats();#}
{#      #}
{#      // Animation d'entr√©e des cartes avec d√©lais calcul√©s en JS#}
{#      allCards.forEach((card, index) => {#}
{#        card.style.opacity = '0';#}
{#        const dataIndex = parseInt(card.getAttribute('data-index')) || index;#}
{#        setTimeout(() => {#}
{#          card.style.opacity = '1';#}
{#          card.classList.add('card-enter');#}
{#          card.style.animationDelay = (dataIndex * 0.05) + 's';#}
{#        }, dataIndex * 50);#}
{#      });#}
{##}
{#      // Gestion du raccourci clavier pour la recherche#}
{#      document.getElementById('nameFilter').addEventListener('keydown', function(e) {#}
{#        if (e.key === 'Enter') {#}
{#          applyFilters();#}
{#        }#}
{#      });#}
{#    });#}
{##}
{#    // Effet parallax l√©ger au scroll#}
{#    window.addEventListener('scroll', () => {#}
{#      const scrolled = window.pageYOffset;#}
{#      const particles = document.querySelectorAll('.particle');#}
{#      particles.forEach((particle, index) => {#}
{#        const speed = 0.3 + (index % 3) * 0.1;#}
{#        particle.style.transform = `translateY(${scrolled * speed}px)`;#}
{#      });#}
{#    });#}
{##}
{#    // Recherche en temps r√©el am√©lior√©e#}
{#    let searchTimeout;#}
{#    document.getElementById('nameFilter').addEventListener('input', function() {#}
{#      clearTimeout(searchTimeout);#}
{#      searchTimeout = setTimeout(() => {#}
{#        applyFilters();#}
{#      }, 300);#}
{#    });#}
{##}
{#    // Gestion du focus pour une meilleure UX#}
{#    document.getElementById('nameFilter').addEventListener('focus', function() {#}
{#      this.style.boxShadow = '0 0 0 0.25rem rgba(103, 126, 234, 0.25)';#}
{#    });#}
{##}
{#    document.getElementById('nameFilter').addEventListener('blur', function() {#}
{#      this.style.boxShadow = '';#}
{#    });#}
{##}
{#    // Raccourcis clavier#}
{#    document.addEventListener('keydown', function(e) {#}
{#      // Ctrl/Cmd + F pour focus sur la recherche#}
{#      if ((e.ctrlKey || e.metaKey) && e.key === 'f') {#}
{#        e.preventDefault();#}
{#        document.getElementById('nameFilter').focus();#}
{#      }#}
{#      #}
{#      // Escape pour reset les filtres#}
{#      if (e.key === 'Escape') {#}
{#        resetFilters();#}
{#        document.getElementById('nameFilter').blur();#}
{#      }#}
{#    });#}
{#  </script>#}
{#</body>#}
{#</html>#}









{#{% load static %}#}
{#<!DOCTYPE html>#}
{#<html lang="fr">#}
{#<head>#}
{#  <meta charset="UTF-8" />#}
{#  <meta name="viewport" content="width=device-width, initial-scale=1.0" />#}
{#  <title>Liste des personnes recens√©es</title>#}
{#  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />#}
{#  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />#}
{#  <style>#}
{#    :root {#}
{#      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);#}
{#      --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);#}
{#      --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);#}
{#      --card-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);#}
{#      --card-hover-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);#}
{#      --text-primary: #2c3e50;#}
{#      --text-secondary: #718096;#}
{#      --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);#}
{#    }#}
{##}
{#    * {#}
{#      margin: 0;#}
{#      padding: 0;#}
{#      box-sizing: border-box;#}
{#    }#}
{##}
{#    body {#}
{#      background: var(--bg-gradient);#}
{#      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;#}
{#      min-height: 100vh;#}
{#      color: var(--text-primary);#}
{#      overflow-x: hidden;#}
{#    }#}
{##}
{#    .container {#}
{#      max-width: 1400px;#}
{#      position: relative;#}
{#    }#}
{##}
{#    .header-section {#}
{#      text-align: center;#}
{#      margin-bottom: 4rem;#}
{#      position: relative;#}
{#    }#}
{##}
{#    .header-title {#}
{#      font-size: 3.5rem;#}
{#      font-weight: 800;#}
{#      background: var(--primary-gradient);#}
{#      -webkit-background-clip: text;#}
{#      -webkit-text-fill-color: transparent;#}
{#      background-clip: text;#}
{#      margin-bottom: 1rem;#}
{#      animation: fadeInUp 1s ease-out;#}
{#    }#}
{##}
{#    .header-subtitle {#}
{#      font-size: 1.2rem;#}
{#      color: var(--text-secondary);#}
{#      font-weight: 300;#}
{#      animation: fadeInUp 1s ease-out 0.2s both;#}
{#    }#}
{##}
{#    .profile-card {#}
{#      background: rgba(255, 255, 255, 0.95);#}
{#      backdrop-filter: blur(20px);#}
{#      border-radius: 24px;#}
{#      box-shadow: var(--card-shadow);#}
{#      padding: 2.5rem;#}
{#      margin-bottom: 2rem;#}
{#      position: relative;#}
{#      overflow: hidden;#}
{#      transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);#}
{#      transform: translateY(0);#}
{#      border: 1px solid rgba(255, 255, 255, 0.2);#}
{#    }#}
{##}
{#    .profile-card::before {#}
{#      content: '';#}
{#      position: absolute;#}
{#      top: 0;#}
{#      left: -100%;#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);#}
{#      transition: left 0.8s;#}
{#    }#}
{##}
{#    .profile-card:hover::before {#}
{#      left: 100%;#}
{#    }#}
{##}
{#    .profile-card:hover {#}
{#      transform: translateY(-10px) scale(1.02);#}
{#      box-shadow: var(--card-hover-shadow);#}
{#    }#}
{##}
{#    .profile-card.validated {#}
{#      border: 3px solid #10b981;#}
{#      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);#}
{#    }#}
{##}
{#    .profile-card.rejected {#}
{#      border: 3px solid #ef4444;#}
{#      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(255, 255, 255, 0.95) 100%);#}
{#    }#}
{##}
{#    .avatar-container {#}
{#      position: relative;#}
{#      margin: 0 auto 2rem;#}
{#      width: 120px;#}
{#      height: 120px;#}
{#    }#}
{##}
{#    .avatar {#}
{#      width: 120px;#}
{#      height: 120px;#}
{#      border-radius: 50%;#}
{#      border: 4px solid transparent;#}
{#      background: var(--primary-gradient);#}
{#      padding: 4px;#}
{#      object-fit: cover;#}
{#      transition: all 0.5s ease;#}
{#      animation: float 3s ease-in-out infinite;#}
{#    }#}
{##}
{#    .avatar-inner {#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      border-radius: 50%;#}
{#      object-fit: cover;#}
{#    }#}
{##}
{#    .status-badge {#}
{#      position: absolute;#}
{#      top: -10px;#}
{#      right: -10px;#}
{#      width: 40px;#}
{#      height: 40px;#}
{#      border-radius: 50%;#}
{#      display: flex;#}
{#      align-items: center;#}
{#      justify-content: center;#}
{#      font-size: 1.2rem;#}
{#      color: white;#}
{#      opacity: 0;#}
{#      transform: scale(0);#}
{#      transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);#}
{#    }#}
{##}
{#    .status-badge.validated {#}
{#      background: linear-gradient(135deg, #10b981, #059669);#}
{#      opacity: 1;#}
{#      transform: scale(1);#}
{#    }#}
{##}
{#    .status-badge.rejected {#}
{#      background: linear-gradient(135deg, #ef4444, #dc2626);#}
{#      opacity: 1;#}
{#      transform: scale(1);#}
{#    }#}
{##}
{#    .person-name {#}
{#      font-size: 1.8rem;#}
{#      font-weight: 700;#}
{#      margin-bottom: 1.5rem;#}
{#      background: var(--primary-gradient);#}
{#      -webkit-background-clip: text;#}
{#      -webkit-text-fill-color: transparent;#}
{#      background-clip: text;#}
{#    }#}
{##}
{#    .info-grid {#}
{#      display: grid;#}
{#      grid-template-columns: 1fr 1fr;#}
{#      gap: 1.5rem;#}
{#      margin-bottom: 2rem;#}
{#    }#}
{##}
{#    .info-item {#}
{#      background: rgba(103, 126, 234, 0.05);#}
{#      padding: 1.2rem;#}
{#      border-radius: 16px;#}
{#      border-left: 4px solid var(--primary-gradient);#}
{#      transition: all 0.3s ease;#}
{#    }#}
{##}
{#    .info-item:hover {#}
{#      transform: translateX(5px);#}
{#      background: rgba(103, 126, 234, 0.1);#}
{#    }#}
{##}
{#    .info-label {#}
{#      font-size: 0.9rem;#}
{#      font-weight: 600;#}
{#      color: var(--text-secondary);#}
{#      margin-bottom: 0.5rem;#}
{#      text-transform: uppercase;#}
{#      letter-spacing: 0.5px;#}
{#    }#}
{##}
{#    .info-value {#}
{#      font-size: 1.1rem;#}
{#      font-weight: 600;#}
{#      color: var(--text-primary);#}
{#    }#}
{##}
{#    .analysis-section {#}
{#      background: rgba(103, 126, 234, 0.05);#}
{#      padding: 1.5rem;#}
{#      border-radius: 16px;#}
{#      margin-bottom: 2rem;#}
{#      border: 1px solid rgba(103, 126, 234, 0.1);#}
{#    }#}
{##}
{#    .analysis-title {#}
{#      font-size: 1.1rem;#}
{#      font-weight: 600;#}
{#      color: var(--text-primary);#}
{#      margin-bottom: 1rem;#}
{#      display: flex;#}
{#      align-items: center;#}
{#      gap: 0.5rem;#}
{#    }#}
{##}
{#    .analysis-content {#}
{#      max-height: 120px;#}
{#      overflow-y: auto;#}
{#      font-size: 0.95rem;#}
{#      line-height: 1.6;#}
{#      color: var(--text-secondary);#}
{#      scrollbar-width: thin;#}
{#      scrollbar-color: rgba(103, 126, 234, 0.3) transparent;#}
{#    }#}
{##}
{#    .analysis-content::-webkit-scrollbar {#}
{#      width: 6px;#}
{#    }#}
{##}
{#    .analysis-content::-webkit-scrollbar-thumb {#}
{#      background: rgba(103, 126, 234, 0.3);#}
{#      border-radius: 3px;#}
{#    }#}
{##}
{#    .action-buttons {#}
{#      display: flex;#}
{#      gap: 1rem;#}
{#      justify-content: center;#}
{#    }#}
{##}
{#    .btn-action {#}
{#      padding: 1rem 2.5rem;#}
{#      border-radius: 50px;#}
{#      font-weight: 600;#}
{#      font-size: 1rem;#}
{#      text-decoration: none;#}
{#      display: inline-flex;#}
{#      align-items: center;#}
{#      gap: 0.8rem;#}
{#      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);#}
{#      position: relative;#}
{#      overflow: hidden;#}
{#      text-transform: uppercase;#}
{#      letter-spacing: 0.5px;#}
{#    }#}
{##}
{#    .btn-action::before {#}
{#      content: '';#}
{#      position: absolute;#}
{#      top: 0;#}
{#      left: -100%;#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);#}
{#      transition: left 0.5s;#}
{#    }#}
{##}
{#    .btn-action:hover::before {#}
{#      left: 100%;#}
{#    }#}
{##}
{#    .btn-validate {#}
{#      background: var(--success-gradient);#}
{#      color: white;#}
{#      border: none;#}
{#      box-shadow: 0 10px 30px rgba(79, 172, 254, 0.4);#}
{#    }#}
{##}
{#    .btn-validate:hover {#}
{#      transform: translateY(-3px) scale(1.05);#}
{#      box-shadow: 0 15px 40px rgba(79, 172, 254, 0.6);#}
{#      color: white;#}
{#    }#}
{##}
{#    .btn-reject {#}
{#      background: var(--danger-gradient);#}
{#      color: white;#}
{#      border: none;#}
{#      box-shadow: 0 10px 30px rgba(250, 112, 154, 0.4);#}
{#    }#}
{##}
{#    .btn-reject:hover {#}
{#      transform: translateY(-3px) scale(1.05);#}
{#      box-shadow: 0 15px 40px rgba(250, 112, 154, 0.6);#}
{#      color: white;#}
{#    }#}
{##}
{#    .btn-action:disabled {#}
{#      opacity: 0.6;#}
{#      cursor: not-allowed;#}
{#      transform: none !important;#}
{#    }#}
{##}
{#    .floating-particles {#}
{#      position: fixed;#}
{#      top: 0;#}
{#      left: 0;#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      pointer-events: none;#}
{#      z-index: -1;#}
{#    }#}
{##}
{#    .particle {#}
{#      position: absolute;#}
{#      background: rgba(103, 126, 234, 0.1);#}
{#      border-radius: 50%;#}
{#      animation: float-particle 15s infinite linear;#}
{#    }#}
{##}
{#    .loading-overlay {#}
{#      position: fixed;#}
{#      top: 0;#}
{#      left: 0;#}
{#      width: 100%;#}
{#      height: 100%;#}
{#      background: rgba(255, 255, 255, 0.9);#}
{#      backdrop-filter: blur(10px);#}
{#      display: none;#}
{#      align-items: center;#}
{#      justify-content: center;#}
{#      z-index: 9999;#}
{#    }#}
{##}
{#    .loader {#}
{#      width: 60px;#}
{#      height: 60px;#}
{#      border: 4px solid rgba(103, 126, 234, 0.2);#}
{#      border-top: 4px solid #667eea;#}
{#      border-radius: 50%;#}
{#      animation: spin 1s linear infinite;#}
{#    }#}
{##}
{#    @keyframes fadeInUp {#}
{#      from {#}
{#        opacity: 0;#}
{#        transform: translateY(50px);#}
{#      }#}
{#      to {#}
{#        opacity: 1;#}
{#        transform: translateY(0);#}
{#      }#}
{#    }#}
{##}
{#    @keyframes float {#}
{#      0%, 100% { transform: translateY(0px); }#}
{#      50% { transform: translateY(-10px); }#}
{#    }#}
{##}
{#    @keyframes float-particle {#}
{#      0% {#}
{#        transform: translateY(100vh) rotate(0deg);#}
{#        opacity: 0;#}
{#      }#}
{#      10% {#}
{#        opacity: 1;#}
{#      }#}
{#      90% {#}
{#        opacity: 1;#}
{#      }#}
{#      100% {#}
{#        transform: translateY(-100vh) rotate(360deg);#}
{#        opacity: 0;#}
{#      }#}
{#    }#}
{##}
{#    @keyframes spin {#}
{#      0% { transform: rotate(0deg); }#}
{#      100% { transform: rotate(360deg); }#}
{#    }#}
{##}
{#    @keyframes pulse {#}
{#      0%, 100% { transform: scale(1); }#}
{#      50% { transform: scale(1.05); }#}
{#    }#}
{##}
{#    .card-enter {#}
{#      animation: cardEnter 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);#}
{#    }#}
{##}
{#    @keyframes cardEnter {#}
{#      from {#}
{#        opacity: 0;#}
{#        transform: translateY(50px) scale(0.9);#}
{#      }#}
{#      to {#}
{#        opacity: 1;#}
{#        transform: translateY(0) scale(1);#}
{#      }#}
{#    }#}
{##}
{#    @media (max-width: 768px) {#}
{#      .header-title {#}
{#        font-size: 2.5rem;#}
{#      }#}
{#      #}
{#      .info-grid {#}
{#        grid-template-columns: 1fr;#}
{#      }#}
{#      #}
{#      .action-buttons {#}
{#        flex-direction: column;#}
{#      }#}
{#      #}
{#      .btn-action {#}
{#        justify-content: center;#}
{#      }#}
{#    }#}
{#  </style>#}
{#</head>#}
{#<body>#}
{#  <div class="floating-particles" id="particles"></div>#}
{#  #}
{#  <div class="loading-overlay" id="loadingOverlay">#}
{#    <div class="loader"></div>#}
{#  </div>#}
{##}
{#  <div class="container my-5">#}
{#    <div class="header-section">#}
{#      <h1 class="header-title">#}
{#        <i class="fas fa-users me-3"></i>#}
{#        Analyse des Recensements#}
{#      </h1>#}
{#      <p class="header-subtitle">Validation et traitement des donn√©es collect√©es</p>#}
{#    </div>#}
{##}
{#    {% for personne in personnes %}#}
{#      {% if forloop.first or forloop.counter0|divisibleby:3 %}#}
{#        <div class="row">#}
{#      {% endif %}#}
{#      #}
{#      <div class="col-lg-4 col-md-6">#}
{#        <div class="profile-card card-enter" data-person-id="{{ personne.id }}" data-index="{{ forloop.counter0 }}">#}
{#          #}
{#          <div class="avatar-container">#}
{#            <div class="avatar">#}
{#              <img src="{% static 'images/default_avatar.png' %}" alt="Avatar" class="avatar-inner" />#}
{#            </div>#}
{#            <div class="status-badge" id="status-{{ personne.id }}">#}
{#              <i class="fas fa-check"></i>#}
{#            </div>#}
{#          </div>#}
{##}
{#          <h3 class="person-name">{{ personne.first_name }} {{ personne.last_name }}</h3>#}
{##}
{#          <div class="info-grid">#}
{#            <div class="info-item">#}
{#              <div class="info-label">#}
{#                <i class="fas fa-user-tie me-1"></i>#}
{#                Recenseur#}
{#              </div>#}
{#              <div class="info-value">#}
{#                {% if personne.recenseur %}{{ personne.recenseur.username }}{% else %}Non assign√©{% endif %}#}
{#              </div>#}
{#            </div>#}
{##}
{#            <div class="info-item">#}
{#              <div class="info-label">#}
{#                <i class="fas fa-chart-line me-1"></i>#}
{#                Niveau Pauvret√©#}
{#              </div>#}
{#              <div class="info-value">{{ personne.niveau_pauvrete|default:"N/A" }}%</div>#}
{#            </div>#}
{#          </div>#}
{##}
{#          <div class="info-item" style="margin-bottom: 2rem;">#}
{#            <div class="info-label">#}
{#              <i class="fas fa-tag me-1"></i>#}
{#              Cat√©gorie#}
{#            </div>#}
{#            <div class="info-value">{{ personne.categorie_predite|default:"Non d√©termin√©e" }}</div>#}
{#          </div>#}
{##}
{#          <div class="analysis-section">#}
{#            <div class="analysis-title">#}
{#              <i class="fas fa-brain"></i>#}
{#              Analyse IA#}
{#            </div>#}
{#            <div class="analysis-content">#}
{#              {{ personne.analyse_llm|default:"Aucune analyse disponible pour le moment." }}#}
{#            </div>#}
{#          </div>#}
{##}
{#          <div class="action-buttons">#}
{#            <a href="{% url 'valider_personne' personne.id %}" #}
{#               class="btn-action btn-validate" #}
{#               onclick="handleValidation(event, {{ personne.id }}, 'validate')">#}
{#              <i class="fas fa-check-circle"></i>#}
{#              Valider#}
{#            </a>#}
{#            <a href="{% url 'rejeter_personne' personne.id %}" #}
{#               class="btn-action btn-reject"#}
{#               onclick="handleValidation(event, {{ personne.id }}, 'reject')">#}
{#              <i class="fas fa-times-circle"></i>#}
{#              Rejeter#}
{#            </a>#}
{#          </div>#}
{#        </div>#}
{#      </div>#}
{##}
{#      {% if forloop.counter|divisibleby:3 or forloop.last %}#}
{#        </div>#}
{#      {% endif %}#}
{#    {% endfor %}#}
{#  </div>#}
{##}
{#  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>#}
{#  <script>#}
{#    // Syst√®me de particules flottantes#}
{#    function createParticles() {#}
{#      const particlesContainer = document.getElementById('particles');#}
{#      const particleCount = 20;#}
{#      #}
{#      for (let i = 0; i < particleCount; i++) {#}
{#        const particle = document.createElement('div');#}
{#        particle.className = 'particle';#}
{#        particle.style.left = Math.random() * 100 + '%';#}
{#        particle.style.width = particle.style.height = Math.random() * 20 + 10 + 'px';#}
{#        particle.style.animationDelay = Math.random() * 15 + 's';#}
{#        particle.style.animationDuration = (Math.random() * 10 + 10) + 's';#}
{#        particlesContainer.appendChild(particle);#}
{#      }#}
{#    }#}
{##}
{#    // Gestion des validations/rejets#}
{#    let processedCards = new Set();#}
{##}
{#    function handleValidation(event, personId, action) {#}
{#      event.preventDefault();#}
{#      #}
{#      if (processedCards.has(personId)) {#}
{#        return false;#}
{#      }#}
{##}
{#      const card = document.querySelector(`[data-person-id="${personId}"]`);#}
{#      const statusBadge = document.getElementById(`status-${personId}`);#}
{#      const buttons = card.querySelectorAll('.btn-action');#}
{#      const loadingOverlay = document.getElementById('loadingOverlay');#}
{##}
{#      // Afficher le loader#}
{#      loadingOverlay.style.display = 'flex';#}
{##}
{#      // D√©sactiver les boutons#}
{#      buttons.forEach(btn => {#}
{#        btn.style.pointerEvents = 'none';#}
{#        btn.style.opacity = '0.6';#}
{#      });#}
{##}
{#      // Animation de traitement#}
{#      card.style.transform = 'scale(0.95)';#}
{#      #}
{#      setTimeout(() => {#}
{#        // Masquer le loader#}
{#        loadingOverlay.style.display = 'none';#}
{#        #}
{#        // Marquer comme trait√©#}
{#        processedCards.add(personId);#}
{#        #}
{#        // Appliquer les styles selon l'action#}
{#        if (action === 'validate') {#}
{#          card.classList.add('validated');#}
{#          statusBadge.classList.add('validated');#}
{#          statusBadge.innerHTML = '<i class="fas fa-check"></i>';#}
{#          #}
{#          // Animation de succ√®s#}
{#          card.style.animation = 'pulse 0.6s ease-in-out';#}
{#          #}
{#          // Particules de c√©l√©bration#}
{#          createCelebrationParticles(card);#}
{#          #}
{#        } else if (action === 'reject') {#}
{#          card.classList.add('rejected');#}
{#          statusBadge.classList.add('rejected');#}
{#          statusBadge.innerHTML = '<i class="fas fa-times"></i>';#}
{#          #}
{#          // Animation de rejet#}
{#          card.style.filter = 'grayscale(0.3)';#}
{#        }#}
{##}
{#        // Restaurer la transformation#}
{#        card.style.transform = 'translateY(-10px) scale(1.02)';#}
{#        #}
{#        // Mettre √† jour les boutons#}
{#        buttons.forEach(btn => {#}
{#          btn.style.pointerEvents = 'none';#}
{#          btn.style.opacity = '0.5';#}
{#          if (btn.textContent.trim().toLowerCase().includes(action === 'validate' ? 'valider' : 'rejeter')) {#}
{#            btn.innerHTML = action === 'validate' ? #}
{#              '<i class="fas fa-check-double"></i> Valid√©' : #}
{#              '<i class="fas fa-ban"></i> Rejet√©';#}
{#            btn.style.opacity = '1';#}
{#          }#}
{#        });#}
{##}
{#        // Notification#}
{#        showNotification(action === 'validate' ? 'Personne valid√©e avec succ√®s!' : 'Personne rejet√©e.', action);#}
{#        #}
{#      }, 1500);#}
{##}
{#      return false;#}
{#    }#}
{##}
{#    // Particules de c√©l√©bration#}
{#    function createCelebrationParticles(card) {#}
{#      const rect = card.getBoundingClientRect();#}
{#      const centerX = rect.left + rect.width / 2;#}
{#      const centerY = rect.top + rect.height / 2;#}
{##}
{#      for (let i = 0; i < 12; i++) {#}
{#        const particle = document.createElement('div');#}
{#        particle.style.position = 'fixed';#}
{#        particle.style.left = centerX + 'px';#}
{#        particle.style.top = centerY + 'px';#}
{#        particle.style.width = '8px';#}
{#        particle.style.height = '8px';#}
{#        particle.style.background = '#10b981';#}
{#        particle.style.borderRadius = '50%';#}
{#        particle.style.pointerEvents = 'none';#}
{#        particle.style.zIndex = '9999';#}
{#        #}
{#        const angle = (i / 12) * Math.PI * 2;#}
{#        const velocity = 100;#}
{#        const vx = Math.cos(angle) * velocity;#}
{#        const vy = Math.sin(angle) * velocity;#}
{#        #}
{#        document.body.appendChild(particle);#}
{#        #}
{#        let startTime = Date.now();#}
{#        function animateParticle() {#}
{#          const elapsed = Date.now() - startTime;#}
{#          const progress = elapsed / 1000;#}
{#          #}
{#          if (progress < 1) {#}
{#            const x = centerX + vx * progress;#}
{#            const y = centerY + vy * progress - 0.5 * 200 * progress * progress;#}
{#            const opacity = 1 - progress;#}
{#            #}
{#            particle.style.left = x + 'px';#}
{#            particle.style.top = y + 'px';#}
{#            particle.style.opacity = opacity;#}
{#            #}
{#            requestAnimationFrame(animateParticle);#}
{#          } else {#}
{#            document.body.removeChild(particle);#}
{#          }#}
{#        }#}
{#        animateParticle();#}
{#      }#}
{#    }#}
{##}
{#    // Syst√®me de notifications#}
{#    function showNotification(message, type) {#}
{#      const notification = document.createElement('div');#}
{#      notification.style.cssText = `#}
{#        position: fixed;#}
{#        top: 20px;#}
{#        right: 20px;#}
{#        padding: 1rem 2rem;#}
{#        background: ${type === 'validate' ? 'linear-gradient(135deg, #10b981, #059669)' : 'linear-gradient(135deg, #ef4444, #dc2626)'};#}
{#        color: white;#}
{#        border-radius: 50px;#}
{#        font-weight: 600;#}
{#        z-index: 10000;#}
{#        transform: translateX(400px);#}
{#        transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);#}
{#        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);#}
{#      `;#}
{#      notification.textContent = message;#}
{#      #}
{#      document.body.appendChild(notification);#}
{#      #}
{#      setTimeout(() => {#}
{#        notification.style.transform = 'translateX(0)';#}
{#      }, 100);#}
{#      #}
{#      setTimeout(() => {#}
{#        notification.style.transform = 'translateX(400px)';#}
{#        setTimeout(() => document.body.removeChild(notification), 500);#}
{#      }, 3000);#}
{#    }#}
{##}
{#    // Initialisation#}
{#    document.addEventListener('DOMContentLoaded', function() {#}
{#      createParticles();#}
{#      #}
{#      // Animation d'entr√©e des cartes avec d√©lais calcul√©s en JS#}
{#      const cards = document.querySelectorAll('.profile-card');#}
{#      cards.forEach((card, index) => {#}
{#        card.style.opacity = '0';#}
{#        const dataIndex = parseInt(card.getAttribute('data-index')) || index;#}
{#        setTimeout(() => {#}
{#          card.style.opacity = '1';#}
{#          card.classList.add('card-enter');#}
{#          card.style.animationDelay = (dataIndex * 0.1) + 's';#}
{#        }, dataIndex * 100);#}
{#      });#}
{#    });#}
{##}
{#    // Effet parallax l√©ger au scroll#}
{#    window.addEventListener('scroll', () => {#}
{#      const scrolled = window.pageYOffset;#}
{#      const particles = document.querySelectorAll('.particle');#}
{#      particles.forEach((particle, index) => {#}
{#        const speed = 0.5 + (index % 3) * 0.2;#}
{#        particle.style.transform = `translateY(${scrolled * speed}px)`;#}
{#      });#}
{#    });#}
{#  </script>#}
{#</body>#}
{#</html>#}